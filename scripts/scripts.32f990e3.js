"use strict";function appConfig(a,b){var c={templateUrl:"views/main.html",controller:"MainCtrl",controllerAs:"main",reloadOnSearch:!1,resolve:{yearsData:["fraserData","$q",function(a,b){var c=b.defer();return a.getData().then(function(a){c.resolve(a)},function(){c.reject("data not found")}),c.promise}]}};a.when("/",c).when("/:catchAll*",c),b.html5Mode({enabled:!0,requireBase:!1})}function mainController(a,b){var c=this;c.yearsData=a,"dataset"==b.search().page||"graph"==b.search().page?c.page=b.search().page:c.page="map"}function mapDirectiveController(a,b,c,d){function e(){d.clearAreaParams(),d.updateQueryParam("min-year",null),d.updateQueryParam("sort-field",null),d.updateQueryParam("sort-reversed",null),d.updateQueryParam("date-type",null),d.updateQueryParam("filter",null);var a=d.getQueryParamValue("max-year",null),b=d.getQueryParamValue("year",null);E=d3.keys(t.yearsData),H=_.last(E),+a?E.indexOf(a)>0&&(H=a):+b&&E.indexOf(b)>0&&(H=b),t.currentYear=H,d.updateQueryParam("max-year",null),d.updateQueryParam("type",null),d.updateQueryParam("year",H),$(".disabled").click(function(a){return a.preventDefault(),!1}),f()}function f(){D=d3.geomap.choropleth().geofile("vendors/d3-geomap/topojson/world/countries.json").height(w).width($("#graph").width()).projection(d3.geo.mercator).colors(_.map(t.colorRange,"color")).column("summary_index").duration(!1).zoomFactor(2).domain([0,10]).unitId("iso_code").format(d3.format(",.02f")).legend(!1).onGeofileLoad(function(a){i(),h(),r()}).onClick(function(a){a&&(p(),q(),C.value(D._.zoomBehavior.scale()))}).postUpdate(g);var a=H;t.slider.value=E.indexOf(H)+1,t.slider.dataValues=E,d3.select("#graph").datum(t.yearsData[a]).call(D.draw,D),y=t.yearsData[a]}function g(){m(),q(),a.safeApply()}function h(){d3.selectAll(".unit").on("mouseover",function(b){v=d3.select(".tooltip-map"),z=b.data;var c=z?parseFloat(z[D.column()],10):!1;t.tooltipCountry={name:b.properties.name,rank:z?b.data.ranking:"N/A",color:"#505050",flagClass:"flag-"+b.id.toLowerCase(),score:z&&c>0?c.toFixed(2):"N/A"},v.classed("hidden",!1),a.safeApply()}).on("mousemove",function(){var b=d3.event,c=b.clientX-150,d=b.clientY-(v.node().getBoundingClientRect().height+8);v.classed("hidden",!1).attr("style","left:"+c+"px; top:"+d+"px"),a.safeApply()}).on("mouseout",function(){v.classed("hidden",!0),z=null,t.tooltipCountry=null})}function i(){var a=$("#typeahead");c.getItems().then(function(b){function c(a,b){var c=a.toUpperCase().indexOf(b.toUpperCase()),d=$("<span></span>");if(0>c)return d.text(a);d.text(a.substring(0,c));var e=$('<span class="select2-rendered__match"></span>');return e.text(a.substring(c,c+b.length)),d.append(e),d.append(a.substring(c+b.length)),d}var e=(_.forEach(b,function(b){a.append($("<option>",b))}),{});$.fn.select2.amd.require(["select2/compat/matcher"],function(b){F=a.select2({dropdownParent:$(".header-controls"),dropdownCssClass:"map-typeahed--dropdown",templateResult:function(a,b){if(a.loading)return a.text;var b=e.term||"",d=c(a.text,b);return d},matcher:b(function(a,b){return 0==b.toUpperCase().indexOf(a.toUpperCase())?!0:!1}),language:{searching:function(a){return e=a,"Searchingâ€¦"}},maximumSelectionLength:5})}),a.on("select2:unselect",function(a){a&&a.params&&a.params.data&&a.params.data.id&&j(a.params.data.id)}),a.on("select2:select",function(a){a&&a.params&&a.params.data&&a.params.data.id&&j(a.params.data.id)}),a.on("change",function(b,c){G=a.val()||[],console.log(G),G.length>0?d.updateQueryParam("countries",a.val().join(",")):d.updateQueryParam("countries",null)});var f=d.getCountriesFromParams(b);$("#typeahead").val(f.length>0?f:null),f.length>0&&(console.log(f),f.forEach(function(a){j(a)}))})}function j(a){console.log(a);var b=_.find(d3.selectAll(".unit").data(),{id:a});b&&D.clicked(b)}function k(){var a=parseInt(this.getAttribute("data-zoom")),b=1;d3.event.preventDefault(),b=D._.zoomBehavior.scale()+1*a,l(b)}function l(a){var b=[D.properties.width/2,D.properties.height/2],c=D._.zoomBehavior.scaleExtent(),d=D._.zoomBehavior.translate(),e=[],f=[],g={x:d[0],y:d[1],k:D._.zoomBehavior.scale()};return a<c[0]||a>c[1]?!1:(e=[(b[0]-g.x)/g.k,(b[1]-g.y)/g.k],g.k=a,f=[e[0]*g.k+g.x,e[1]*g.k+g.y],g.x+=b[0]-f[0],g.y+=b[1]-f[1],D._.zoomBehavior.scale(g.k),C.value(g.k),D._.zoomBehavior.translate([g.x,g.y]),D.zoom(),void 0)}function m(){t.tableData={mostFree:[],quartile2:[],quartile3:[],leastFree:[]};var a=d3.selectAll(".unit").data(),b=u-1,c=[],d=null,e=null,f=null,g=null,h=0,i="";b>=0&&(c=t.yearsData[E[b]]),a=a.filter(function(a){return a.data?!0:!1}),a.sort(function(a,b){return a.data.ranking-b.data.ranking});for(var j=0;j<a.length;j++)if(d=a[j].data,f=_.find(c,{iso_code:d.iso_code}),f&&(h=d[D.column()]-f[D.column()],0>h?i="fa-arrow-down":h>0&&(i="fa-arrow-up"),d.arrowClass=i),e=D.colorScale(d[D.column()]),g=_.find(t.colorRange,{color:e}))switch(g.name){case"most-free":t.tableData.mostFree.push(d);break;case"2nd-quart":t.tableData.quartile2.push(d);break;case"3rd-quart":t.tableData.quartile3.push(d);break;case"least-free":t.tableData.leastFree.push(d)}}function n(){x=$(".main-panel").width(),w=$(".main-panel").height(),D.path.projection().translate([x/2,w/2+150]).scale([x/5]).precision(.1),D.svg.attr("width",x).attr("height",w),D.svg.select("rect").attr("width",x).attr("height",w),D.svg.selectAll("path").attr("d",D.path),D.width(x),D.height(w)}function o(){A=window.setTimeout(function(){n(),window.clearTimeout(A)},200)}function p(a){$("#typeahead").val(_.map(D._.selectedList,function(a){return a.id.toUpperCase()})).trigger("change")}function q(){var b="world";G=[],d3.selectAll(".unit.active").each(function(a){G.push(a)}),t.selectedCountries=_.map(G,function(a){return a.tracker=a.id+"-"+t.currentYear,a}),t.selectedCountries.length>0&&(b="country-info"),$('.nav-pills a[href="#'+b+'"]').tab("show"),a.safeApply()}function r(){d3.select(".legend-panel").selectAll("div").data(_.reverse(t.colorRange)).enter().append("div").classed("legend-color",!0).style("background-color",function(a){return a.color})}function s(){D.data=t.yearsData[t.currentYear]||[],D.update()}var t=this;t.tableData={mostFree:[],quartile2:[],quartile3:[],leastFree:[]};var u=null;t.onSliderChange=function(b,c){u=b,t.currentYear=c,m(),s(),q(),d.updateQueryParam("year",c),a.safeApply()},t.slider={value:0,step:1,dataValues:[]};var v=null,w=$(".main-panel").height(),x=$(".main-panel").width(),y=($("#typeahead"),[],null),z=null,A=null,B=[{color:"#ee3b58",name:"least-free",value:3,text:"Least Free"},{color:"#fcab4a",name:"3rd-quart",value:2,text:"3rd Quartile"},{color:"#b8d051",name:"2nd-quart",value:1,text:"2nd Quartile"},{color:"#00bbbc",name:"most-free",value:0,text:"Most Free"}];t.colorRange=B;var C=d3.slider().min(1).max(10).step(1).orientation("vertical");d3.select("#zoom-slide").call(C),C.on("slide",function(){l(C.value())}),d3.selectAll("i[data-zoom]").on("click",k);var D,E,F,G,H;e(),d3.select(window).on("resize",o),a.safeApply=function(b){var c=this.$root.$$phase;"$apply"==c||"$digest"==c?b&&"function"==typeof b&&b():a.$apply(b)}}function sliderDirectiveLink(a,b,c){function d(){a.min=1,a.max=a.data.length,a.d3Slider=d3.slider().step("undefined"!=typeof a.step?a.step:1).value(a.value).animate(!1).min(a.min).max(a.max).orientation(a.orientation).snap(!1);var b=setInterval(function(){d3.select("."+a.id).selectAll("*").remove(),d3.select("."+a.id).call(a.d3Slider),$("."+a.id+" a.d3-slider-handle").append(l),_.isArray(a.value)?e(a.value):l.html(a.data[a.value-1]),a.safeApply(),window.clearInterval(b),f()},50);a.d3Slider.on("slide",function(){f()}),a.d3Slider.on("slideend",function(){f()})}function e(b){$("#handle-one .popover-single-value").html(a.data[b[0]-1]),$("#handle-two .popover-single-value").html(a.data[b[1]-1]);var c;c=setTimeout(function(){var a=$("#handle-two .popover-single-value").offset().left-$("#handle-one .popover-single-value").offset().left;$(".d3-slider-range").width(a),window.clearTimeout(c)},0)}function f(){var b=a.d3Slider.value();if(_.isArray(b))b[0]===b[1]&&b[0]--,e(b),a.onValueChange({dataValue:[b[0]-1,b[1]-1],value:[a.data[b[0]-1],a.data[b[1]-1]]});else{var c=a.d3Slider.value()-1,d=a.data[c];l.html(d),a.onValueChange({dataValue:c,value:d})}a.safeApply()}function g(){a.pauseState?h():i()}function h(){a.pauseState=!1,k=setInterval(function(){var b=a.d3Slider.value();if(b<a.max){j=!1;var c=b+a.step;a.d3Slider.value(c>a.max?a.max:c),f()}else j?(b=a.min,a.d3Slider.value(a.min)):(j=!0,i()),f(),a.safeApply()},750)}function i(){a.pauseState=!0,window.clearInterval(k),a.safeApply()}a.id="slider-"+(new Date).getTime(),a.pauseState=!0;var j=!0,k=null,l=$('<div class="slider-popover popover-single-value"></div>');a.$watch(function(){return a.data},function(a,b){d()}),a.$watch(function(){return a.value},function(a,b){d()}),a.playPause=g,d(),a.safeApply=function(a){var b=this.$root.$$phase;"$apply"==b||"$digest"==b?a&&"function"==typeof a&&a():this.$apply(a)}}function fraserDataset(a,b,c){function d(){var a=_.find(m.filterList,{id:+c.getQueryParamValue("filter",0)});a||(a=m.filterList[0],c.getQueryParamValue("filter",0)),m.filter.selectedText=a.name,m.filter.selected=a.id}function e(){m.table={orderField:c.getQueryParamValue("sort-field","summary_index"),orderReversed:1==+c.getQueryParamValue("sort-reversed",1)?!0:!1}}function f(){var a,b=_.last(m.dataPoints);if("range"==m.dateType){if(b=[m.dataPoints[0],_.last(m.dataPoints)],a=_.clone(b),a[0]=c.getQueryParamValue("min-year",b[0]),a[1]=c.getQueryParamValue("max-year",b[1]),c.updateQueryParam("year",null),+a[0]>+a[1]){var d=a[0];a[0]=a[1],a[1]=d}return m.dataPoints.indexOf(a[0])<0&&(a[0]=b[0]),m.dataPoints.indexOf(a[1])<0&&(a[1]=b[1]),{years:a,yearIndex:[m.dataPoints.indexOf(a[0])+1,m.dataPoints.indexOf(a[1])+1]}}return a=c.getQueryParamValue("year",b),c.updateQueryParam("min-year",null),c.updateQueryParam("max-year",null),m.dataPoints.indexOf(a)<0&&(a=b),{year:a,yearIndex:m.dataPoints.indexOf(a)+1}}function g(){var a=f();m.currentYear=a.year,m.slider={value:a.yearIndex,step:1,dataValues:m.dataPoints},m.onSliderChange=function(a,d){m.currentYear=d,_.isArray(d)?(c.updateQueryParam("min-year",d[0]),c.updateQueryParam("max-year",d[1])):c.updateQueryParam("year",d),i(),b.safeApply()},i()}function h(a){return _.map(m.yearsData[a],function(b){var c={};return c.iso_code=b.iso_code,c.country=b.country,c.year=a,c.category=q(b.summary_index),c.summary_index=b.summary_index,c.trStyle={color:p(b.summary_index)},c.sizeOfGoverment=b.Area1.value,c.sizeOfGovermentStyle={color:p(parseFloat(c.sizeOfGoverment))},c.legalSystem=b.Area2.value,c.legalSystemStyle={color:p(parseFloat(c.legalSystem))},c.soundMoney=b.Area3.value,c.soundMoneyStyle={color:p(parseFloat(c.soundMoney))},c.freedomToTrade=b.Area4.value,c.freedomToTradeStyle={color:p(parseFloat(c.freedomToTrade))},c.regulation=b.Area5.value,c.regulationStyle={color:p(parseFloat(c.regulation))},c})}function i(){if(_.isArray(m.currentYear)){m.tableData=[];for(var a=m.dataPoints.indexOf(m.currentYear[0]),c=m.dataPoints.indexOf(m.currentYear[1]),d=a;c>=d;d++)m.tableData=m.tableData.concat(h(m.dataPoints[d]))}else m.tableData=h(m.currentYear);m.tableData.sort(function(a,b){return b.summary_index-a.summary_index}),m.tableData.forEach(function(a,b){a.ranking=b+1}),m.filterChanged(),b.safeApply()}function j(){m.filter.countries=$(".chosen-select").val()||[],b.safeApply(),c.updateQueryParam("countries",m.filter.countries.length?m.filter.countries.join(","):null)}function k(){var d=$(".chosen-select");d.html(""),a.getItems().then(function(a){function e(a,b){var c=a.toUpperCase().indexOf(b.toUpperCase()),d=$("<span></span>");if(0>c)return d.text(a);d.text(a.substring(0,c));var e=$('<span class="select2-rendered__match"></span>');return e.text(a.substring(c,c+b.length)),d.append(e),d.append(a.substring(c+b.length)),d}var f=(_.forEach(a,function(a){d.append($("<option>",a))}),{});o=d.select2({width:"100%",dropdownCssClass:"map-typeahed--dropdown",templateResult:function(a){if(a.loading)return a.text;var b=f.term||"",c=e(a.text,b);return c},maximumSelectionLength:5}),d.on("select2:unselect",function(a){a&&a.params&&a.params.data&&a.params.data.id&&j()}),d.on("select2:select",function(a){a&&a.params&&a.params.data&&a.params.data.id&&j()}),d.on("change",function(a,b){j()}),m.filter.countries=c.getCountriesFromParams(a),a.length>0&&(m.filter.selected=1,$(".chosen-select").val(m.filter.countries).trigger("change"),m.filterChanged()),b.safeApply()})}function l(){d(),g(),k(),e(),b.safeApply()}c.clearAreaParams(),c.updateQueryParam("type",null);var m=this,n=d3.keys(m.yearsData);m.dataPoints=n,m.dateType=c.getQueryParamValue("date-type","single"),m.filter={selected:null,limit:0,categories:[{id:1,name:"MOST FREE",cssClass:"filter-most-free",active:!0,color:"#00bbbc"},{id:2,name:"2ND QUARTILE",cssClass:"filter-2nd-quart",active:!0,color:"#b8d051"},{id:3,name:"3RD QUARTILE",cssClass:"filter-3rd-quart",active:!0,color:"#fcab4a"},{id:4,name:"LEAST FREE",cssClass:"filter-least-free",active:!0,color:"#ee3b58"}],countries:[]},m.tableCategoryFilter=function(a){if(2!=m.filter.selected)return a;var b=_.find(m.filter.categories,{id:a.category});return b.active?a:void 0},m.tableCountryFilter=function(a,b,c){return 1!=m.filter.selected?a:0==m.filter.countries.length?a:m.filter.countries.indexOf(a.iso_code)>=0?a:void 0},m.filterChanged=function(){3==m.filter.selected?m.filter.limit=10:m.filter.limit=m.tableData.length,c.updateQueryParam("filter",m.filter.selected),b.safeApply()},m.filterList=[{id:0,name:"ALL"},{id:1,name:"INDIVIDUAL COUNTRY"},{id:2,name:"ECONOMIC FREEDOM QUARTILE"},{id:3,name:"TOP 10 COUNTRIES"},{id:4,name:"CUSTOM"}],m.selectFilter=function(a){m.filter.selectedText=a.name,m.filter.selected=a.id,m.filterChanged()},m.setTableOrdering=function(a){c.updateQueryParam("sort-field",a),m.table.orderField==a?m.table.orderReversed=!m.table.orderReversed:(m.table.orderField=a,m.table.orderReversed=!0),c.updateQueryParam("sort-reversed",m.table.orderReversed?1:0)},m.setDateType=function(a){m.dateType=a,c.updateQueryParam("date-type",a),"single"==m.dateType?(c.updateQueryParam("max-year",null),c.updateQueryParam("min-year",null),c.updateQueryParam("year",2014),m.slider.value=21):(c.updateQueryParam("max-year",2011),c.updateQueryParam("min-year",2014),c.updateQueryParam("year",null),m.slider.value=[18,21])},m.tableData=[];var o,p=d3.scale.quantize().domain([0,10]).range(_.map(m.filter.categories,"color").reverse()),q=d3.scale.quantize().domain([0,10]).range(_.map(m.filter.categories,"id").reverse());b.safeApply=function(a){var c=this.$root.$$phase;"$apply"==c||"$digest"==c?a&&"function"==typeof a&&a():b.$apply(a)},l()}function fraserGraph(a,b,c){function d(){_.forEach(v.yearsData,function(a,b){v.worldData[b]=e(a,b)})}function e(a,b){var c=_.extend(h(),{year:b,country:"World",iso_code:"WOR"}),d="",e=0,f=0;a.forEach(function(a){a.year=b,e=0;for(var f=0;f<v.categories.length;f++)d=v.categories[f].key,e=+_.get(c,d,0)+ +_.get(a,d,0),_.set(c,d,e)}),e=0;for(var g=0;g<v.categories.length;g++)d=v.categories[g].key,e=_.get(c,d,0)/a.length,_.set(c,d,e),f+=e;return c.summary_index=f/v.categories.length,c}function f(){x=$("#charts").width();var a={top:20,right:20,bottom:30,left:20};x=x-a.left-a.right,y=400-a.top-a.bottom,F=d3.scale.ordinal().rangeRoundBands([0,x],.1),E=d3.scale.ordinal().rangeRoundBands([0,x],.1),G=d3.scale.ordinal(),H=d3.scale.linear().range([y,0]).domain([0,10]),z=d3.svg.axis().scale(E).orient("bottom"),A=d3.svg.axis().scale(F).orient("bottom"),B=d3.svg.axis().innerTickSize(-x).outerTickSize(0).scale(H).orient("left"),C=d3.select("#charts").append("svg").attr("width",x+a.left+a.right).attr("height",y+a.top+a.bottom).attr("align","center").append("g").attr("transform","translate("+a.left+","+a.top+")"),C.append("g").attr("class","y axis").call(B).append("text").attr("transform","rotate(-90)").attr("y",5).attr("dy","1em").style("text-anchor","end");var b=d3.select(C.selectAll(".y.axis .tick")[0][0]);b.select("text").attr("visibility","hidden"),b.select("line").attr("class","first-y-axis"),D=C.append("g").attr("class","tooltip-chart").style("display","none"),D.append("rect").attr("width",40).attr("height",20).attr("fill","white").style("opacity",1),D.append("text").attr("x",15).attr("dy","1.2em").style("text-anchor","middle").attr("font-size","12px").attr("font-weight","bold")}function g(){var a=v.yearsData[v.currentYear];if(v.filter.countries.length>0){var c=_.filter(v.countriesList,function(a){return v.filter.countries.indexOf(a.value)>=0}),d={};v.graphData=_.map(c,function(b){return d=_.find(a,{iso_code:b.value}),b.country=b.text,b.summary_index=0,d&&(b.Area1=d.Area1,b.Area2=d.Area2,b.Area3=d.Area3,b.Area4=d.Area4,b.Area5=d.Area5,b.summary_index=d.summary_index),b})}else{var d=v.worldData[v.currentYear];v.graphData=d?[d]:[]}b.safeApply(),p()}function h(){return{Area1:{value:0},Area2:{value:0},Area3:{value:0},Area4:{value:0},Area5:{value:0},summary_index:0}}function i(a){var b=_.filter(v.categories,{active:!0});return b.length!==v.categories.length&&b.length>0&&(a.calculated_index=0,_.forEach(b,function(c){var d=(+_.get(a,c.key,0)).toFixed(2)/b.length;a.calculated_index+=d})),a}function j(){v.lineGraphData=[];var a,b,c,d=v.dateRange,e=[];if(v.filter.countries.length>0){var f=_.filter(v.countriesList,function(a){return v.filter.countries.indexOf(a.value)>=0});v.lineGraphData=f.map(function(f,g){a={iso_code:f.value,country:f.text,color:v.categories[g].color,values:[]};for(var j=d[0];j<=d[1];j++)c=v.dataPoints[j],e=v.yearsData[c],b=_.find(e,{iso_code:f.value}),b=b?b:h(),b.year=c,b.calculated_index=b.summary_index,b=i(b),b.calculated_index>0&&a.values.push(b);return a})}else{for(var g=[],j=d[0];j<=d[1];j++)c=v.dataPoints[j],b=v.worldData[c],b.calculated_index=b.summary_index,g.push(i(b));v.lineGraphData=[{iso_code:"WOR",country:"WORLD",color:v.categories[0].color,values:g}]}v.lineGraphData=_.map(v.lineGraphData,function(a){return a}),o()}function k(){C.select(".x.axis").remove(),C.selectAll(".country").remove(),C.selectAll(".line-graph").remove()}function l(){v.categories.forEach(function(a){c.updateQueryParam(a.queryParam,a.active?1:0)}),v.filter.countries.length>0&&c.updateQueryParam("countries",v.filter.countries.join(",")),"bar"===v.graphSelector?g():j(),b.safeApply()}function m(a,b){return F(a)+F.rangeBand()/2-b}function n(a,c,d,e){D=d3.select(".tooltip-graph"),D.classed("hidden",!1),D.attr("style","left:"+d+"px;top:"+e+"px"),v.tooltipValue=a,b.$apply()}function o(){k(),F.domain(_.filter(v.dataPoints,function(a,b){return b>=v.dateRange[0]&&b<=v.dateRange[1]?a:void 0})),C.append("g").attr("class","x axis line-x-axis").attr("transform","translate(0,"+y+")").call(A);var a=d3.svg.line().x(function(a){return m(a.year,20)}).y(function(a){return H(a.calculated_index)}).defined(function(a){return a.calculated_index>0}),b=C.append("g").attr("transform","translate(20,20)").attr("class","line-graph"),c=b.selectAll(".country").data(v.lineGraphData).enter().append("g").attr("class","country");c.append("path").attr("class","line").attr("style",function(a,b){return"stroke : "+a.color+";"}).attr("d",function(b){return a(b.values)});var d;v.lineGraphData.forEach(function(a){d=b.selectAll(".circle-"+a.iso_code).data(a.values).enter(),d.append("circle").attr("class",function(b){return"circle-"+a.iso_code+"-"+b.year}).attr("style",function(b,c){return"stroke : "+a.color+";"}).attr("r",4).attr("cx",function(a){return m(a.year,20)}).attr("cy",function(a){return H(a.calculated_index)}).on("mouseover",function(a){var b=$(this).position();b.left-=20,b.top-=40,n(a.calculated_index,this,b.left,b.top)}).on("mouseout",function(){D.classed("hidden",!0),v.tooltipValue=null})})}function p(){k();var a=_.filter(v.categories,{active:!0});v.graphData.forEach(function(b){b.categories=_.map(a,function(a){var c=(+_.get(b,a.key,0)).toFixed(2);return{name:a.name,value:c,label:c>.5?c:"N/A",color:a.color}})}),E.domain(v.graphData.map(function(a){return a.country}));var c=d3.min([(x-100)/5,150]);G.domain(v.categories.filter(function(a){return a.active}).map(function(a){return a.name})).rangeRoundBands([0,c]),C.append("g").attr("class","x axis").attr("transform","translate(0,"+y+")").call(z);var d=C.selectAll(".country").data(v.graphData),e=d.enter().append("g").attr("class","country").style("fill","blue").attr("transform",function(a){return"translate("+E(a.country)+",0)"}),f=e.selectAll("rect").data(function(a){return a.categories});f.exit().remove(),f.enter().append("rect").attr("width",function(){return G.rangeBand()-2}).attr("x",function(a){return G(a.name)+1+E.rangeBand()/2-c/2}).attr("y",function(a){return H(a.value)}).attr("height",function(a){return y-H(a.value)}).style("fill",function(a){return a.color}).on("mouseover",function(a){var b=(G.rangeBand()-2)/2,c=$(this).position();c.left=c.left-25+b,c.top-=40,n(a.value,this,c.left,c.top)}).on("mouseout",function(){D.classed("hidden",!0),v.tooltipValue=null}),b.safeApply()}function q(a){v.slider={value:a,step:1,dataValues:w},v.dateRange=[v.slider.value[0]-1,v.dataPoints.length-1],v.onSliderChange=function(a,b){_.isArray(a)?(v.dateRange=a,c.updateQueryParam("min-year",b[0]),c.updateQueryParam("max-year",b[1]),c.updateQueryParam("year",null)):(v.currentYear=b,c.updateQueryParam("min-year",null),c.updateQueryParam("max-year",null),c.updateQueryParam("year",b)),l()}}function r(){var b=$("#typeahead");a.getItems().then(function(a){function c(a,b){var c=a.toUpperCase().indexOf(b.toUpperCase()),d=$("<span></span>");if(0>c)return d.text(a);d.text(a.substring(0,c));var e=$('<span class="select2-rendered__match"></span>');return e.text(a.substring(c,c+b.length)),d.append(e),d.append(a.substring(c+b.length)),d}f(),v.countriesList=a;var d=(_.forEach(a,function(a){b.append($("<option>",a))}),{});I=b.select2({dropdownCssClass:"map-typeahed--dropdown",templateResult:function(a){if(a.loading)return a.text;var b=d.term||"",e=c(a.text,b);return e},maximumSelectionLength:5}),b.on("select2:unselect",function(a){a&&a.params&&a.params.data&&a.params.data.id&&(v.filter.countries=b.val()||[],l())}),b.on("select2:select",function(a){a&&a.params&&a.params.data&&a.params.data.id&&(v.filter.countries=b.val()||[],l())}),b.on("change",function(a,c){v.filter.countries=b.val()||[],l()}),u()})}function s(){var a,b=_.last(v.dataPoints);if("line"==v.graphSelector){if(b=[v.dataPoints[0],_.last(v.dataPoints)],a=_.clone(b),a[0]=c.getQueryParamValue("min-year",b[0]),a[1]=c.getQueryParamValue("max-year",b[1]),+a[0]>+a[1]){var d=a[0];a[0]=a[1],a[1]=d}return v.dataPoints.indexOf(a[0])<0&&(a[0]=b[0]),v.dataPoints.indexOf(a[1])<0&&(a[1]=b[1]),{years:a,yearIndex:[v.dataPoints.indexOf(a[0])+1,v.dataPoints.indexOf(a[1])+1]}}return a=c.getQueryParamValue("year",b),v.dataPoints.indexOf(a)<0&&(a=b),{year:a,yearIndex:v.dataPoints.indexOf(a)+1}}function t(){v.categories.forEach(function(a){a.active=+c.getQueryParamValue(a.queryParam,1)>0?!0:!1,c.updateQueryParam(a.queryParam,a.active?1:0)})}function u(){var a=c.getQueryParamValue("type","line");"line"!=a&&"bar"!=a&&(a="line");var b=s();q(b.yearIndex),_.isArray(b.year)?(c.updateQueryParam("min-year",b.year[0]),c.updateQueryParam("max-year",b.year[1])):c.updateQueryParam("year",b.year),v.filter.countries=c.getCountriesFromParams(v.countriesList),$("#typeahead").val(v.filter.countries).trigger("change"),t(),v.changeGraph(a)}c.updateQueryParam("sort-field",null),c.updateQueryParam("sort-reversed",null),c.updateQueryParam("date-type",null),c.updateQueryParam("filter",null);var v=this,w=d3.keys(v.yearsData);v.dataPoints=w,v.worldData={},b.safeApply=function(a){var c=this.$root.$$phase;"$apply"==c||"$digest"==c?a&&"function"==typeof a&&a():b.$apply(a)},v.selectAllCategories=!0,v.toggleCategory=function(a){a.active=!a.active,l()},v.toggleAllCategories=function(a){a||(v.selectAllCategories=!v.selectAllCategories),v.categories.forEach(function(a){a.active=v.selectAllCategories}),l()},v.changeGraph=function(a){v.graphSelector=a,c.updateQueryParam("type",a),v.slider.value=s().yearIndex,l()},v.filter={countries:[]},v.categories=[{name:"Size of Government",active:!0,color:"#ce0932",key:"Area1.value",queryParam:"area1"},{name:"Legal System and Property Rights",active:!0,color:"#dd8c2c",key:"Area2.value",queryParam:"area2"},{name:"Sound Money",active:!0,color:"#74862c",key:"Area3.value",queryParam:"area3"},{name:"Freedom to Trade Internationally",active:!0,color:"#00a3a4",key:"Area4.value",queryParam:"area4"},{name:"Regulation",active:!0,color:"#90a738",key:"Area5.value",queryParam:"area5"}],v.buildGraphData=l;var x,y,z,A,B,C,D,E,F,G,H,I;d(),r()}function dataService(a,b){var c=36e5;return"localStorage"in window||(window.localStorage={_data:{},setItem:function(a,b){return this._data[a]=String(b)},getItem:function(a){return this._data.hasOwnProperty(a)?this._data[a]:void 0},removeItem:function(a){return delete this._data[a]},clear:function(){return this._data={}}}),{getData:function(){var d=b.defer(),e=window.localStorage.getItem("fraser.data"),f=window.localStorage.getItem("fraser.data.time");f=f?+f:0;var g=(new Date).getTime()-f>c;return e&&!g?d.resolve(JSON.parse(e)):a.get("/fraser.json",{cache:!0}).then(function(a){200==a.status&&200==a.data.code&&a.data.data&&(window.localStorage.setItem("fraser.data",JSON.stringify(a.data.data)),window.localStorage.setItem("fraser.data.time",(new Date).getTime()),d.resolve(a.data.data))},function(a){d.reject(a)}),d.promise}}}function typeAheadService(a,b){var c=[],e=[];return{setItems:function(a){c=a},getItems:function(){var e=b.defer();return c.length>0?d.resolve(c):a.get("vendors/d3-geomap/topojson/world/countries.json").then(function(a){200==a.status?(c=_.map(_.get(a,"data.objects.units.geometries"),function(a){return{value:a.id,text:a.properties.name}}),e.resolve(c)):e.reject("data not found")},function(){e.reject("data not found")}),e.promise},setSelected:function(a){e=a},getSelecetd:function(){return e}}}function paramsService(a){function b(){for(var a=1;5>=a;a++)d("area"+a,null)}function c(b,c){return _.get(a.search(),b,c)}function d(b,c){a.search(b,c)}function e(a){var b=c("countries","");b=b.toUpperCase();var e=[],f=b.split(",");return f.length>0&&f.forEach(function(b){_.find(a,{value:b})&&e.push(b)}),e=e.splice(0,5),d("countries",e.length>0?e.join(","):null),e}return{getQueryParamValue:c,updateQueryParam:d,getCountriesFromParams:e,clearAreaParams:b}}angular.module("fraserMapApp",["ngAnimate","ngAria","ngCookies","ngMessages","ngResource","ngRoute","ngSanitize","ngTouch"]).config(appConfig),appConfig.$inject=["$routeProvider","$locationProvider"],angular.module("fraserMapApp").controller("MainCtrl",mainController),mainController.$inject=["yearsData","$location"],angular.module("fraserMapApp").directive("fraserMap",function(){return{templateUrl:"views/map-page.html",restrict:"E",controller:mapDirectiveController,controllerAs:"vm",bindToController:!0,scope:{yearsData:"="},link:function(){}}}),mapDirectiveController.$inject=["$scope","$timeout","typeaheadService","fraserParams"],angular.module("fraserMapApp").directive("fraserSlider",function(){return{templateUrl:"views/partials/slider.html",restrict:"E",scope:{orientation:"=",step:"=",value:"=",data:"=",showPlay:"=",onValueChange:"&"},link:sliderDirectiveLink}}),angular.module("fraserMapApp").directive("mapCountryPanel",function(){return{templateUrl:"views/partials/map-country-panel.html",restrict:"E",scope:{country:"=",colorRange:"="},link:function(a,b,c){function d(){a.data={},a.data.summary_index=a.country.data?a.country.data.summary_index+" / 10":"N/A",a.data.name=a.country.properties.name,a.data.flagIcon="flag-"+a.country.id.toLowerCase(),a.data.color=_.get(a.country,"data.color",null);var b=_.find(a.colorRange,{color:a.data.color});a.data.labelClass="label label-nodata",a.data.labelText="no data",b&&(a.data.labelClass="label label-"+b.name,a.data.labelText=b.text),a.articles=[{head:"Size of Government",icon:"fa-area-chart",key:"data.Area1.value",value:null},{head:"Legal System and Property Rights",icon:"fa-first-order",key:"data.Area2.value",value:null},{head:"Sound Money",icon:"fa-archive",key:"data.Area3.value",value:null},{head:"Freedom to Trade Internationally",icon:"fa-building",key:"data.Area4.value",value:null},{head:"Regulation",icon:"fa-beer",key:"data.Area5.value",value:null}];var c;console.log(a.country),a.articles.forEach(function(b){c=_.get(a.country,b.key,null),b.value=c?parseFloat(c).toFixed(2):"N/A"})}a.$watch(function(){return a.country.tracker},function(a,b){a!=b&&d()}),d()}}}),angular.module("fraserMapApp").directive("fraserDataset",function(){return{templateUrl:"views/dataset-page.html",controllerAs:"vm",controller:fraserDataset,restrict:"E",bindToController:!0,scope:{yearsData:"="},link:function(){}}}),fraserDataset.$inject=["typeaheadService","$scope","fraserParams"],angular.module("fraserMapApp").directive("fraserGraph",function(){return{templateUrl:"views/graph-page.html",controllerAs:"vm",controller:fraserGraph,restrict:"E",bindToController:!0,scope:{yearsData:"="},link:function(){}}}),fraserGraph.$inject=["typeaheadService","$scope","fraserParams"],angular.module("fraserMapApp").service("fraserData",dataService),dataService.$inject=["$http","$q"],angular.module("fraserMapApp").service("typeaheadService",typeAheadService),typeAheadService.$inject=["$http","$q"],angular.module("fraserMapApp").service("fraserParams",paramsService),paramsService.$inject=["$location"],angular.module("fraserMapApp").run(["$templateCache",function(a){a.put("views/dataset-page.html",'<div class="container-fluid dataset-header"> <div class="col-sm-offset-1 col-md-10 dataset-header-container"> <div class="col-md-9 dataset-header-wrapper"> <div class="dataset-title">Download Dataset</div> <div class="dataset-subtitle">Economic Freedom Rankings</div> <div class="dropdown dataset-datarange-selector"> <span class="dropdown-toggle" type="button" data-toggle="dropdown"> {{vm.dateType == "single" ? "Select Specific Date" : "Select Date Range"}} <span class="caret"></span> </span> <ul class="dropdown-menu"> <li><a ng-click="vm.setDateType(\'range\')">Date Range</a></li> <li><a ng-click="vm.setDateType(\'single\')">Specific Dates</a></li> </ul> </div> </div> <div class="col-md-3 fraser-download-container"> <div class="fraser-download-container--cell"> <div class="fraser-download-container--wrapper"> <button class="btn btn-primary fraser-download-button"> Download Entire Dataset <i class="fa fa-download fraser-download-button--icon" aria-hidden="true"></i> </button> </div> </div> </div> </div> <div class="col-sm-offset-1 col-md-10 dataset-slider-container"> <fraser-slider show-play="false" step="1" value="vm.slider.value" data="vm.slider.dataValues" orientation="\'horizontal\'" on-value-change="vm.onSliderChange(dataValue, value)"> </fraser-slider> </div> </div> <div class="container-fluid filters"> <div class="col-sm-offset-1 col-md-10 filters-wrapper"> <i class="fa fa-filter filter-icon" aria-hidden="true"></i> <span>Filter By : </span> <span class="dropdown dataset-filter-selector"> <span class="dropdown-toggle dataset-filter-button" type="button" data-toggle="dropdown"> {{vm.filter.selectedText}} <span class="caret"></span> </span> <ul class="dropdown-menu"> <li ng-repeat="filter in vm.filterList" ng-click="vm.selectFilter(filter)"> <a ng-bind="filter.name"></a> </li> </ul> </span> <span class="dataset-filter-container"> <div class="quartile-filters" ng-show="vm.filter.selected == 2"> <span ng-repeat="category in vm.filter.categories" ng-click="category.active = !category.active" class="{{category.cssClass}}" ng-class="{\'inactive\': !category.active}" ng-bind="category.name"></span> </div> <div class="typeahead-filters" ng-show="vm.filter.selected == 1"> <select data-placeholder="Find a country" multiple class="chosen-select"> <option></option> </select> </div> </span> <span class="dataset-filter-download-wrapper"> <i class="fa fa-download fraser-download-button--icon pull-right" aria-hidden="true"></i> <button class="fraser-download-filtered-button pull-right"> Download Filtered Dataset </button> </span> </div> </div> <div class="dataset-panel container-fluid"> <div class="col-sm-offset-1 col-md-10 dataset-table-panel"> <table class="table dataset-table"> <thead> <tr> <th ng-click="vm.setTableOrdering(\'ranking\')" class="text-center" width="20"> OVERALL RANK <span ng-show="vm.table.orderField == \'ranking\' && !vm.table.orderReversed" class="fa fa-caret-down"></span> <span ng-show="vm.table.orderField == \'ranking\' && vm.table.orderReversed" class="fa fa-caret-up"></span> </th> <th ng-click="vm.setTableOrdering(\'country\')" class="text-center"> COUNTRY NAME <span ng-show="vm.table.orderField == \'country\' && !vm.table.orderReversed" class="fa fa-caret-down"></span> <span ng-show="vm.table.orderField == \'country\' && vm.table.orderReversed" class="fa fa-caret-up"></span> </th> <th ng-click="vm.setTableOrdering(\'year\')" class="text-center" width="60"> YEAR <span ng-show="vm.table.orderField == \'year\' && !vm.table.orderReversed" class="fa fa-caret-down"></span> <span ng-show="vm.table.orderField == \'year\' && vm.table.orderReversed" class="fa fa-caret-up"></span> </th> <th ng-click="vm.setTableOrdering(\'summary_index\')" class="text-center" width="40"> OVERALL SCORE <span ng-show="vm.table.orderField == \'summary_index\' && !vm.table.orderReversed" class="fa fa-caret-down"></span> <span ng-show="vm.table.orderField == \'summary_index\' && vm.table.orderReversed" class="fa fa-caret-up"></span> </th> <th ng-click="vm.setTableOrdering(\'sizeOfGoverment\')" class="text-center" width="13%"> SIZE OF GOVERMENT <span ng-show="vm.table.orderField == \'sizeOfGoverment\' && !vm.table.orderReversed" class="fa fa-caret-down"></span> <span ng-show="vm.table.orderField == \'sizeOfGoverment\' && vm.table.orderReversed" class="fa fa-caret-up"></span> </th> <th ng-click="vm.setTableOrdering(\'legalSystem\')" class="text-center" width="13%"> Legal System and Property Rights <span ng-show="vm.table.orderField == \'legalSystem\' && !vm.table.orderReversed" class="fa fa-caret-down"></span> <span ng-show="vm.table.orderField == \'legalSystem\' && vm.table.orderReversed" class="fa fa-caret-up"></span> </th> <th ng-click="vm.setTableOrdering(\'soundMoney\')" class="text-center" width="13%"> SOUND MONEY <span ng-show="vm.table.orderField == \'soundMoney\' && !vm.table.orderReversed" class="fa fa-caret-down"></span> <span ng-show="vm.table.orderField == \'soundMoney\' && vm.table.orderReversed" class="fa fa-caret-up"></span> </th> <th ng-click="vm.setTableOrdering(\'freedomToTrade\')" class="text-center" width="13%"> Freedom to Trade Internationally <span ng-show="vm.table.orderField == \'freedomToTrade\' && !vm.table.orderReversed" class="fa fa-caret-down"></span> <span ng-show="vm.table.orderField == \'freedomToTrade\' && vm.table.orderReversed" class="fa fa-caret-up"></span> </th> <th ng-click="vm.setTableOrdering(\'regulation\')" class="text-center" width="13%"> REGAULATION <span ng-show="vm.table.orderField == \'regulation\' && !vm.table.orderReversed" class="fa fa-caret-down"></span> <span ng-show="vm.table.orderField == \'regulation\' && vm.table.orderReversed" class="fa fa-caret-up"></span> </th> </tr> </thead> <tbody> <tr ng-if="filteredData.length == 0"> <td colspan="9">No data to display</td> </tr> <tr ng-if="filteredData.length > 0" ng-repeat="entry in vm.tableData  \n          | limitTo : vm.filter.limit \n          | filter : vm.tableCategoryFilter\n          | filter : vm.tableCountryFilter\n          | orderBy : vm.table.orderField : vm.table.orderReversed\n          as filteredData\n          track by $index "> <td class="text-center" ng-bind="entry.ranking" ng-style="entry.trStyle"></td> <td class="text-center" ng-bind="entry.country"></td> <td class="text-center" ng-bind="entry.year" width="60"></td> <td class="text-center" ng-bind="entry.summary_index | number: 2" ng-style="entry.trStyle"></td> <td class="text-center" ng-bind="entry.sizeOfGoverment | number: 2" ng-style="entry.sizeOfGovermentStyle"></td> <td class="text-center" ng-bind="entry.legalSystem | number: 2" ng-style="entry.legalSystemStyle"></td> <td class="text-center" ng-bind="entry.soundMoney | number: 2" ng-style="entry.soundMoneyStyle"></td> <td class="text-center" ng-bind="entry.freedomToTrade | number: 2" ng-style="entry.freedomToTradeStyle"></td> <td class="text-center" ng-bind="entry.regulation | number: 2" ng-style="entry.regulationStyle"></td> </tr> </tbody> </table> </div> </div>'),
a.put("views/graph-page.html",'<div class="container-fluid charts-topbar"> <div class="col-sm-offset-2 col-md-10"> <select data-placeholder="Find a country" id="typeahead" multiple class="chosen-select"> <option></option> </select> </div> </div> <div class="charts-container container-fluid"> <div class="col-md-2 charts-selection-panel"> <div class="charts-selector"> <div class="charts-selector-text">GRAPH</div> <div ng-class="{\'active\' : vm.graphSelector == \'line\'}" ng-click="vm.changeGraph(\'line\');" class="charts-selector-buttom"> <i class="fa fa-line-chart" aria-hidden="true"></i> </div> <div ng-class="{\'active\' : vm.graphSelector == \'bar\'}" ng-click="vm.changeGraph(\'bar\')" class="charts-selector-buttom"> <i class="fa fa-bar-chart" aria-hidden="true"></i> </div> </div> </div> <div class="col-md-8"> <div id="charts"></div> <fraser-slider ng-if="vm.slider.value" class="charts-timebar" show-play="false" step="1" value="vm.slider.value" data="vm.slider.dataValues" orientation="\'horizontal\'" on-value-change="vm.onSliderChange(dataValue, value)"> </fraser-slider> </div> <div class="col-md-2"> <div class="legend" ng-if="vm.graphSelector == \'bar\'"> <div ng-repeat="category in vm.categories" class="pointer legend-row" ng-click="vm.toggleCategory(category)"> <span> <i class="fa fa-circle" aria-hidden="true" ng-style="{\n              color: category.active ? category.color : \'gray\'\n            }"> </i> </span> <span ng-bind="category.name" class="category-text"></span> </div> <div class="pointer" ng-click="vm.toggleAllCategories()"> <span ng-bind="vm.selectAllCategories ? \'Deselect All\' : \'Select All\'" class="category-text"></span> </div> </div> <div class="legend" ng-if="vm.graphSelector == \'line\'"> <div ng-repeat="country in vm.lineGraphData" class="pointer legend-row"> <span> <i class="fa fa-circle" aria-hidden="true" ng-style="{\n              color: country.color\n            }"> </i> </span> <span ng-bind="country.country" class="category-text"></span> </div> <div class="graph-category-filter"> <div class="graph-category-filter--title">Filter By Category : </div> <div> <ul class="line-graph-filter-list"> <li class="line-graph-filter-list--item"> <input ng-click="vm.toggleAllCategories(true)" type="checkbox" ng-model="vm.selectAllCategories" ng-attr-id="{{\'category-check-\' + $index}}"> <label for="{{\'category-check-\' + $index}}"> All </label> </li> <li class="line-graph-filter-list--item" ng-repeat="category in vm.categories track by $index"> <input ng-change="vm.buildGraphData()" type="checkbox" ng-model="category.active" ng-attr-id="{{\'category-check-\' + $index}}"> <label for="{{\'category-check-\' + $index}}" ng-bind="category.name"></label> </li> </ul> </div> </div> </div> </div> </div> <ng-include src="\'views/partials/graph-tooltip.html\'"></ng-include>'),a.put("views/main.html",'<fraser-map ng-if="main.page == \'map\'" years-data="main.yearsData"> </fraser-map> <fraser-graph ng-if="main.page == \'graph\'" years-data="main.yearsData"> </fraser-graph> <fraser-dataset class="dataset-page" ng-if="main.page == \'dataset\'" years-data="main.yearsData"> </fraser-dataset>'),a.put("views/map-page.html",'<div class="container-map"> <div class="side-panel"> <ul class="nav nav-pills nav-justified"> <li class="map-tab active"><a data-toggle="tab" href="#world">WORLD RANKINGS</a></li> <li ng-class="{\'disabled\' : vm.selectedCountries.length == 0}" class="country-info--tab"><a data-toggle="tab" href="#country-info">COUNTRY INFO</a></li> </ul> <div class="tab-content"> <!-- WORLD TAB --> <div id="world" class="tab-pane fade in active"> <div class="world-tab-header"> <div class="text-center world-tab-title"> Economic Freedom <br> Ranking <span class="freedom-ranking-year" ng-bind="vm.currentYear"></span> </div> <div class="share-block"> <div class="pull-left text">Share : </div> <div class="pull-right social-icons"> <i class="fa fa-envelope pointer mail" aria-hidden="true"></i> <i class="fa fa-facebook-official pointer facebook" aria-hidden="true"></i> <i class="fa fa-twitter-square pointer twitter" aria-hidden="true"></i> </div> <div class="clearfix"></div> </div> </div> <div class="country-list-wrapper"> <table class="table country-list"> <thead> <tr> <th>#</th> <th>Country</th> <th>Score</th> </tr> </thead> <tbody> <tr class="most-free-tr" ng-if="vm.tableData.mostFree.length > 0"> <th class="first-free-th" colspan="3"> <span class="label label-most-free">Most Free</span> </th> </tr> <tr ng-if="vm.tableData.mostFree.length > 0" ng-repeat="country in vm.tableData.mostFree track by country.iso_code" ng-include="\'views/partials/map-table-row.html\'"> </tr> <tr class="second-free-tr" ng-if="vm.tableData.quartile2.length > 0"> <th class="second-free-th" colspan="3"> <span class="label label-2nd-quart">2nd Quartile</span> </th> </tr> <tr ng-if="vm.tableData.quartile2.length > 0" ng-repeat="country in vm.tableData.quartile2 track by country.iso_code" ng-include="\'views/partials/map-table-row.html\'"> </tr> <tr class="third-free-tr" ng-if="vm.tableData.quartile3.length > 0"> <th class="third-free-th" colspan="3"> <span class="label label-3rd-quart">3rd Quartile</span> </th> </tr> <tr ng-if="vm.tableData.quartile3.length > 0" ng-repeat="country in vm.tableData.quartile3 track by country.iso_code" ng-include="\'views/partials/map-table-row.html\'"></tr> <tr class="least-free-tr" ng-if="vm.tableData.leastFree.length > 0"> <th class="least-free-th" colspan="3"> <span class="label label-least-free">Least Free</span> </th> </tr> <tr ng-if="vm.tableData.leastFree.length > 0" ng-repeat="country in vm.tableData.leastFree track by country.iso_code" ng-include="\'views/partials/map-table-row.html\'"> </tr> <tr class="end-tr"> </tr> </tbody> </table> </div> </div> <!-- END OF WORLD TAB --> <!-- COUNTRY INFO TAB --> <div id="country-info" class="tab-pane fade"> <div id="selected-countries"> <map-country-panel ng-repeat="country in vm.selectedCountries track by country.tracker" color-range="vm.colorRange" country="country"></map-country-panel> </div> </div> <!-- END OF COUNTRY INFO TAB --> </div> </div> <div class="main-panel"> <div id="graph"> <div class="header-controls"> <select data-placeholder="Find a country" id="typeahead" multiple class="chosen-select"> <option></option> </select> </div> <div class="legend-panel"></div> </div> <div class="zoom-buttons"> <i class="fa fa-plus-square pointer" aria-hidden="true" id="zoom_in" data-zoom="+1"></i> <div id="zoom-slide"></div> <i class="fa fa-minus-square pointer" aria-hidden="true" id="zoom_out" data-zoom="-1"></i> </div> <fraser-slider show-play="true" class="footer-controls" step="vm.slider.step" value="vm.slider.value" data="vm.slider.dataValues" orientation="\'horizontal\'" on-value-change="vm.onSliderChange(dataValue, value)"></fraser-slider> </div> </div> <ng-include src="\'views/partials/map-tooltip.html\'"></ng-include> '),a.put("views/partials/graph-tooltip.html",'<div class="hidden tooltip-graph"> <div class="text-center value" ng-bind="vm.tooltipValue | number : 2"> </div> </div>'),a.put("views/partials/map-country-panel.html",'<div class="country-info--item"> <div class="text-center"> <div> <span class="country-flag flag flag-3x" ng-class="data.flagIcon"></span> </div> <h2 class="country-name" ng-bind="data.name"></h2> <h5 class="ranking"> <span class="value" ng-bind="data.summary_index"></span> </h5> <span class="label" ng-class="data.labelClass" ng-bind="data.labelText"></span> <ul class="row"> <li ng-class="{\'no-border\' : $last}" ng-repeat="article in articles track by $index"> <span><i class="article-icon fa" ng-class="article.icon" aria-hidden="true"></i></span> <span class="article-value" ng-bind="article.value"></span> <span class="article-title" ng-bind="article.head"></span> </li> </ul> </div> </div>'),a.put("views/partials/map-sidepanel-world-tab.html",'<div id="world" class="tab-pane fade in active"> <div class="text-center"> <h5>Economic Freedom Ranking</h5> <h2 class="freedom-ranking-year" ng-bind="vm.currentYear"></h2> </div> <div class="share-block"> <div class="pull-left">Share on : </div> <div class="pull-right social-icons"> <i class="fa fa-envelope pointer" aria-hidden="true"></i> <i class="fa fa-facebook-official pointer" aria-hidden="true"></i> <i class="fa fa-twitter-square pointer" aria-hidden="true"></i> </div> <div class="clearfix"></div> </div> <table class="table country-list"> <thead> <tr> <th>#</th> <th>Country</th> <th>Score</th> </tr> </thead> <tbody> <tr class="most-free-tr" ng-if="vm.tableData.mostFree.length > 0"> <th class="first-free-th" colspan="3"> <span class="label label-most-free">Most Free</span> </th> </tr> <tr ng-if="vm.tableData.mostFree.length > 0" ng-repeat="country in vm.tableData.mostFree track by country.iso_code" ng-include="\'views/partials/map-table-row.html\'"> </tr> <tr class="second-free-tr" ng-if="vm.tableData.quartile2.length > 0"> <th class="second-free-th" colspan="3"> <span class="label label-2nd-quart">2nd Quartile</span> </th> </tr> <tr ng-if="vm.tableData.quartile2.length > 0" ng-repeat="country in vm.tableData.quartile2 track by country.iso_code" ng-include="\'views/partials/map-table-row.html\'"> </tr> <tr class="third-free-tr" ng-if="vm.tableData.quartile3.length > 0"> <th class="third-free-th" colspan="3"> <span class="label label-3rd-quart">3rd Quartile</span> </th> </tr> <tr ng-if="vm.tableData.quartile3.length > 0" ng-repeat="country in vm.tableData.quartile3 track by country.iso_code" ng-include="\'views/partials/map-table-row.html\'"></tr> <tr class="least-free-tr" ng-if="vm.tableData.leastFree.length > 0"> <th class="least-free-th" colspan="3"> <span class="label label-least-free">Least Free</span> </th> </tr> <tr ng-if="vm.tableData.leastFree.length > 0" ng-repeat="country in vm.tableData.leastFree track by country.iso_code" ng-include="\'views/partials/map-table-row.html\'"> </tr> <tr class="end-tr"> </tr> </tbody> </table> </div>'),a.put("views/partials/map-table-row.html",'<td ng-bind="country.ranking" style="color: {{country.color}}"> </td> <td ng-bind="country.country"> </td> <td style="color: {{country.color}}"> <span ng-bind="country.summary_index | number : 2"></span> <i class="ranking-difference-indicator fa" ng-class="country.arrowClass" aria-hidden="true"></i> </td>'),a.put("views/partials/map-tooltip.html",'<div class="hiddens tooltip-map"> <div class=""> <span class="tooltip--country-flag flag flag-2x" ng-class="vm.tooltipCountry.flagClass"></span> <span class="country-title" ng-bind="vm.tooltipCountry.name"></span> </div> <div class="country-rank" ng-style="{color: vm.tooltipCountry.color}"> <div class="rank"> <div ng-bind="vm.tooltipCountry.rank"> </div> <div class="rank-title"> RANK</div> </div> <div class="overall"> <div ng-bind="vm.tooltipCountry.score"></div> <div class="score-title">SCORE</div> </div> <div class="clear-both"></div> </div> </div>'),a.put("views/partials/slider.html",'<div class="fraser-slider" ng-class="{\'no-play\' : !showPlay}"> <span ng-if="showPlay"> <span class="timeline-buttom play pointer" ng-click="playPause()"> <i class="fa" ng-class="{\'fa-play\': pauseState, \'fa-pause\': !pauseState}" aria-hidden="true"></i> </span> <span class="timeline-text" ng-bind="pauseState?\'play\':\'pause\';"> </span> </span> <span class="timeline-value min" ng-bind="data[min-1]"></span> <span class="{{id}}"></span> <span class="timeline-value max" ng-bind="data[max-1]"></span> </div>')}]);